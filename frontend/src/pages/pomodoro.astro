---
import '../styles/global.css';
import Timer from '../components/Timer.jsx';
import SideMenu from '../components/SideMenu.jsx';
---

<html lang="es">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<title>Modo Foco - Focus</title>
	</head>
	<body style="
		margin: 0; 
		min-height: 100vh; 
		min-height: 100dvh; 
		font-family: 'Omnes', system-ui, sans-serif; 
		background-image: url('/background_coffe.jpg'); 
		background-size: cover; 
		background-position: center; 
		background-repeat: no-repeat; 
		background-attachment: fixed;
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		padding: 1rem;
	">
        
        <!-- Contenedor principal mobile-first -->
        <div style="
			width: 100%; 
			max-width: 380px; 
			display: flex; 
			flex-direction: column; 
			gap: 0.8rem;
		">
            
            <!-- Header con menú y puntos -->
            <header style="
				display: flex; 
				justify-content: space-between; 
				align-items: center; 
				padding: 0 0.5rem;
				margin-bottom: 5rem;
			">
                <SideMenu client:load />
                
                <!-- Píldora de puntos pequeña -->
                <div style="
					display: flex;
					align-items: center;
					gap: 0.4rem;
					background: rgba(255,255,255,0.95);
					padding: 0.4rem 0.75rem;
					border-radius: 9999px;
					border: 1.5px solid #3C2A20;
				">
                    <img src="/assets/coffee_bean.png" alt="" style="width: 14px; height: 14px; object-fit: contain;" />
                    <span id="user-points" style="font-weight: 600; font-size: 0.75rem; color: #3C2A20;">0 +</span>
                </div>
            </header>
            
            <!-- el componente Timer -->
            <main style="display: flex; flex-direction: column; justify-content: center;">
                <Timer client:load />
            </main>

        </div>

        <!-- Script para los puntos -->
        <script>
            const token = localStorage.getItem('focus_token');
            if(token) {
                const API = import.meta.env.PUBLIC_API_URL || '';
                fetch(`${API}/auth/me`, { headers: { 'Authorization': `Bearer ${token}` } })
                .then(r => r.json())
                .then(u => {
                    const el = document.getElementById('user-points');
                    if(el) el.innerText = (u.current_points || 0) + " +";
                });
            }
        </script>
	</body>
</html>